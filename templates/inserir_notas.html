{% extends "model.html" %}

{% block title %}
    <title>SGA - Inserir Notas</title>
{% endblock %}

{% block content %}

<h2>Inserir Notas por Turma</h2>

<form method="POST">
    <label for="turma_id">Selecione a turma:</label>
    <select name="turma_id" id="turma_id" required>
        <option value="">-- Selecione --</option>
        {% for turma in turmas %}
            <option value="{{ turma.id }}"
                {% if turma_selecionada and turma.id == turma_selecionada.id %}selected{% endif %}>
                {{ turma.serie }} {{ turma.nome }}
            </option>
        {% endfor %}
    </select><br>
    <button  class="btn btn-second" type="submit" name="acao" value="carregar">Carregar</button>
</form>

{% if alunos and disciplinas %}
    <form method="POST">
        <input type="hidden" name="acao" value="salvar">
        <input type="hidden" name="turma_id" value="{{ turma_selecionada.id }}">

        <table>
            <thead>
                <tr>
                    <th>Aluno</th>
                    {% for disciplina in disciplinas %}
                        <th>{{ disciplina.nome }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for aluno in alunos %}
                    <tr>
                        <td><strong>{{ aluno.nome }}</strong><br><small>Matr√≠cula: {{ aluno.matricula }}</small></td>
                        {% for disciplina in disciplinas %}
                            <td>
                                <input type="number" 
                                       name="nota_{{ aluno.id }}_{{ disciplina.id }}" 
                                       value="{{ notas_dict[(aluno.id, disciplina.id)] if (aluno.id, disciplina.id) in notas_dict else '' }}" 
                                       step="0.1" min="0" max="10"
                                       style="width: 70px; text-align: center;">
                            </td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <button  class="btn btn-second" type="submit">Salvar</button>
    </form>
{% endif %}


{% endblock %}
